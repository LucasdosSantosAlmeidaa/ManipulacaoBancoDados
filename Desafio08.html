<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Desafio08</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Desafio08_files/libs/clipboard/clipboard.min.js"></script>
<script src="Desafio08_files/libs/quarto-html/quarto.js"></script>
<script src="Desafio08_files/libs/quarto-html/popper.min.js"></script>
<script src="Desafio08_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Desafio08_files/libs/quarto-html/anchor.min.js"></script>
<link href="Desafio08_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Desafio08_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Desafio08_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Desafio08_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Desafio08_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Desafio08</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># CONFIGURAÇÃO INICIAL</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># CONEXÃO E DIAGNÓSTICO DA ESTRUTURA DO BANCO</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>conn <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="st">"database.sqlite3"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== DIAGNÓSTICO AUTOMÁTICO ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== DIAGNÓSTICO AUTOMÁTICO ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tabelas <span class="ot">&lt;-</span> <span class="fu">dbListTables</span>(conn)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tabelas disponíveis:"</span>, <span class="fu">paste</span>(tabelas, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tabelas disponíveis: course_offerings, courses, grade_distributions, instructors, rooms, schedules, sections, subject_memberships, subjects, teachings </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para diagnosticar cada tabela</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>diagnosticar_tabela <span class="ot">&lt;-</span> <span class="cf">function</span>(nome_tabela) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>nome_tabela <span class="sc">%in%</span> tabelas) {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Tabela '%s' não encontrada</span><span class="sc">\n</span><span class="st">"</span>, nome_tabela))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  estrutura <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="fu">sprintf</span>(<span class="st">"PRAGMA table_info(%s)"</span>, nome_tabela))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="fu">sprintf</span>(<span class="st">"SELECT COUNT(*) as total FROM %s"</span>, nome_tabela))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- %s ---</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">toupper</span>(nome_tabela)))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Colunas: %s</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">paste</span>(estrutura<span class="sc">$</span>name, <span class="at">collapse =</span> <span class="st">", "</span>)))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Registros: %d</span><span class="sc">\n</span><span class="st">"</span>, total<span class="sc">$</span>total))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  pk <span class="ot">&lt;-</span> estrutura[estrutura<span class="sc">$</span>pk <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"name"</span>]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(pk) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Chave primária: %s</span><span class="sc">\n</span><span class="st">"</span>, pk[<span class="dv">1</span>]))</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">estrutura =</span> estrutura, <span class="at">total =</span> total<span class="sc">$</span>total, <span class="at">pk =</span> <span class="cf">if</span>(<span class="fu">length</span>(pk) <span class="sc">&gt;</span> <span class="dv">0</span>) pk[<span class="dv">1</span>] <span class="cf">else</span> <span class="cn">NULL</span>))</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>estruturas <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>tabelas_principais <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"subjects"</span>, <span class="st">"instructors"</span>, <span class="st">"courses"</span>, <span class="st">"course_offerings"</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"grade_distributions"</span>, <span class="st">"teachings"</span>, <span class="st">"subject_memberships"</span>, <span class="st">"sections"</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (tab <span class="cf">in</span> tabelas_principais) {</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  estruturas[[tab]] <span class="ot">&lt;-</span> <span class="fu">diagnosticar_tabela</span>(tab)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- SUBJECTS ---
Colunas: code, name, abbreviation
Registros: 200

--- INSTRUCTORS ---
Colunas: id, name
Registros: 18738

--- COURSES ---
Colunas: uuid, name, number
Registros: 9306

--- COURSE_OFFERINGS ---
Colunas: uuid, course_uuid, term_code, name
Registros: 81453

--- GRADE_DISTRIBUTIONS ---
Colunas: course_offering_uuid, section_number, n_count, c_count, f_count, cr_count, p_count, nw_count, other_count, bc_count, u_count, d_count, ab_count, a_count, s_count, i_count, b_count, nr_count
Registros: 193262

--- TEACHINGS ---
Colunas: instructor_id, section_uuid
Registros: 315211

--- SUBJECT_MEMBERSHIPS ---
Colunas: subject_code, course_offering_uuid
Registros: 95314

--- SECTIONS ---
Colunas: uuid, course_offering_uuid, section_type, number, room_uuid, schedule_uuid
Registros: 370771</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>co_key <span class="ot">&lt;-</span> <span class="st">"uuid"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Usando chave para course_offerings: %s</span><span class="sc">\n</span><span class="st">"</span>, co_key))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Usando chave para course_offerings: uuid</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Teste de Conectividade</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== TESTE DE CONECTIVIDADE ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== TESTE DE CONECTIVIDADE ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>test_query <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"SELECT COUNT(*) as total</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="st">FROM course_offerings co</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 1"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>({</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  test_result <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, test_query)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Conectividade OK: %d registros vinculados</span><span class="sc">\n</span><span class="st">"</span>, test_result<span class="sc">$</span>total))</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>}, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Erro de conectividade: %s</span><span class="sc">\n</span><span class="st">"</span>, e<span class="sc">$</span>message))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conectividade OK: 95314 registros vinculados</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># INVESTIGAÇÃO DE CÓDIGOS DE ESTATÍSTICA</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== PROCURANDO CÓDIGOS DE ESTATÍSTICA ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== PROCURANDO CÓDIGOS DE ESTATÍSTICA ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>stat_variants <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="st">"SELECT code, name, abbreviation,</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="st">        (SELECT COUNT(*) FROM subject_memberships sm WHERE sm.subject_code = s.code) as oferecimentos</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM subjects s</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE UPPER(s.name) LIKE '%STAT%'</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="st">    OR UPPER(s.abbreviation) LIKE '%STAT%'</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="st">   OR s.code = 'STAT'</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY oferecimentos DESC"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Códigos relacionados a Estatística:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Códigos relacionados a Estatística:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stat_variants)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  code                                  name abbreviation oferecimentos
1  932                            Statistics         STAT           747
2  239  Real Estate and Urban Land Economics     REAL EST           353
3  210 Biostatistics and Medical Informatics        B M I           199</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(stat_variants) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> stat_variants<span class="sc">$</span>oferecimentos[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  codigo_estatistica <span class="ot">&lt;-</span> stat_variants<span class="sc">$</span>code[<span class="dv">1</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Usando código: %s (%s) com %d oferecimentos</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>              codigo_estatistica, stat_variants<span class="sc">$</span>name[<span class="dv">1</span>], stat_variants<span class="sc">$</span>oferecimentos[<span class="dv">1</span>]))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Nenhum código específico de estatística encontrado. Usando o mais comum para demonstração.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  top_codes <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="st">"</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT sm.subject_code, s.name, COUNT(*) as total</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM subject_memberships sm</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="st">  LEFT JOIN subjects s ON sm.subject_code = s.code</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY sm.subject_code, s.name</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="st">  ORDER BY total DESC</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="st">  LIMIT 5</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(top_codes)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(top_codes) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    codigo_estatistica <span class="ot">&lt;-</span> top_codes<span class="sc">$</span>subject_code[<span class="dv">1</span>]</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Usando código mais popular para demonstração: %s</span><span class="sc">\n</span><span class="st">"</span>, codigo_estatistica))</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Usando código: 932 (Statistics) com 747 oferecimentos</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ATIVIDADE 1: PROFESSORES DE ESTATÍSTICA</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== PROFESSORES DE ESTATÍSTICA ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== PROFESSORES DE ESTATÍSTICA ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"codigo_estatistica"</span>)) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  query_professores <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT DISTINCT</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="st">      i.name as professor_nome,</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="st">      i.id as professor_id,</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="st">      COUNT(DISTINCT co.uuid) as num_oferecimentos</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM instructors i</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN teachings t ON i.id = t.instructor_id</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN sections s ON t.section_uuid = s.uuid</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN course_offerings co ON s.course_offering_uuid = co.uuid</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE sm.subject_code = '%s'</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY i.name, i.id</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="st">  ORDER BY num_oferecimentos DESC, i.name</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span>, codigo_estatistica)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Query sendo executada:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(query_professores, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    professores_stat <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, query_professores)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(professores_stat) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"SUCESSO! Professores encontrados:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">kable</span>(professores_stat)) <span class="co"># Exibe a tabela</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Total de professores: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(professores_stat)))</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Nenhum professor encontrado para o código selecionado.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Erro na query: %s</span><span class="sc">\n</span><span class="st">"</span>, e<span class="sc">$</span>message))</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Query sendo executada:

  SELECT DISTINCT
      i.name as professor_nome,
      i.id as professor_id,
      COUNT(DISTINCT co.uuid) as num_oferecimentos
  FROM instructors i
  INNER JOIN teachings t ON i.id = t.instructor_id
  INNER JOIN sections s ON t.section_uuid = s.uuid
  INNER JOIN course_offerings co ON s.course_offering_uuid = co.uuid
  INNER JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid
  WHERE sm.subject_code = '932'
  GROUP BY i.name, i.id
  ORDER BY num_oferecimentos DESC, i.name
   

SUCESSO! Professores encontrados:


|professor_nome                |professor_id | num_oferecimentos|
|:-----------------------------|:------------|-----------------:|
|ZHENGJUN ZHANG                |4108525      |                60|
|ERIK NORDHEIM                 |2602042      |                59|
|WEI-YIN LOH                   |2602108      |                56|
|QIAN ZHIGUANG                 |3338237      |                49|
|ZHANG CHUNMING                |1426304      |                47|
|JUN SHAO                      |1079018      |                46|
|BRET LARGET                   |751075       |                41|
|KAM-WAH TSUI                  |2602032      |                41|
|RICHARD J. CHAPPELL           |2601926      |                41|
|CECILE ANE                    |3955546      |                38|
|KARL ROHE                     |4929500      |                38|
|MICHAEL NEWTON                |2601916      |                38|
|BRIAN YANDELL                 |2602055      |                37|
|SUNDUZ KELES                  |3801422      |                37|
|YAZHEN WANG                   |4695492      |                36|
|JUN ZHU                       |321374       |                33|
|GRACE WAHBA                   |2600488      |                31|
|ISMOR FISCHER                 |143932       |                31|
|CHRISTINA M. KENDZIORSKI      |340544       |                30|
|BRET HANLON                   |4753018      |                29|
|SIJIAN WANG                   |3622809      |                29|
|DONALD PORTER                 |393380       |                28|
|ROBERT WARDROP                |2601091      |                28|
|MURRAY CLAYTON                |2601621      |                25|
|JOHN GILLETT                  |608997       |                24|
|DOUGLAS M. BATES              |2602050      |                22|
|NICHOLAS STEPHEN KEULER       |640407       |                22|
|GARVESH RASKUTTI              |5214164      |                21|
|KYUNGMANN KIM                 |207204       |                19|
|MOO K CHUNG                   |3404298      |                19|
|TIMO SEPPALAINEN              |3374880      |                19|
|RONALD GANGNON                |893827       |                18|
|BENEDEK VALKO                 |4538519      |                16|
|KARL BROMAN                   |4541610      |                16|
|SHENGJI JIA                   |5017571      |                16|
|KJELL DOKSUM                  |3404299      |                15|
|STEPHEN WRIGHT                |3382451      |                14|
|XINYU SONG                    |4430246      |                14|
|DAVID GRIFFEATH               |2602109      |                13|
|RUOSI GUO                     |5020061      |                13|
|YU MENGGANG                   |3010828      |                13|
|YI CHAI                       |4285538      |                12|
|JOHN DAVIS                    |4880968      |                11|
|KEVIN PACKARD                 |4744350      |                11|
|SEBASTIEN ROCH                |5110390      |                11|
|THOMAS G. KURTZ               |2601039      |                11|
|XIAO GUO                      |4591139      |                11|
|XIN ZHANG                     |4588103      |                11|
|YAOGUO XIE                    |4895244      |                11|
|BO YANG                       |5632570      |                10|
|DAVID ANDERSON                |4308515      |                10|
|JIAJIE CHEN                   |4590715      |                10|
|JINGLAN LI                    |4902482      |                10|
|JU HEE CHO                    |4731731      |                10|
|LILUN DU                      |4578330      |                10|
|MICHAEL FERRIS                |1114818      |                10|
|SHENG WANG                    |4146030      |                10|
|SHENG ZHANG                   |4285558      |                10|
|YI LI                         |5327139      |                10|
|ZUOFENG SHANG                 |4138542      |                10|
|AKICHIKA OZEKI                |3775809      |                 9|
|CHEN CHENG                    |4586558      |                 9|
|CUIZE HAN                     |5176022      |                 9|
|DEREK BEAN                    |4264265      |                 9|
|DUZHE WANG                    |5516726      |                 9|
|FAN YANG                      |4437355      |                 9|
|FREDERICK BOEHM               |361804       |                 9|
|GONZALO CONTADOR              |5320625      |                 9|
|JIE ZHANG                     |4436368      |                 9|
|JIWEI ZHAO                    |4286103      |                 9|
|TONG LI                       |5329574      |                 9|
|WENWEN ZHANG                  |4590481      |                 9|
|WENZHI CAO                    |5322094      |                 9|
|XIAOMAO LI                    |5170801      |                 9|
|DONGGYU KIM                   |4897725      |                 8|
|GINA BENNINGER                |5017655      |                 8|
|HAO TENG                      |5520701      |                 8|
|HYEBIN SONG                   |5321537      |                 8|
|JARED BROWN                   |4636315      |                 8|
|JUN YIN                       |3620114      |                 8|
|LIE XIONG                     |4277002      |                 8|
|MING YUAN                     |3077702      |                 8|
|PAUL RATHOUZ                  |967335       |                 8|
|QI TANG                       |3974100      |                 8|
|QUOC TRAN                     |4161984      |                 8|
|RICHARD A. JOHNSON            |2601613      |                 8|
|SONG WANG                     |4953246      |                 8|
|THOMAS COOK                   |417071       |                 8|
|TIMOTHY IDOWU                 |4879129      |                 8|
|YAN CHEN                      |4721620      |                 8|
|YOUNGDEOK HWANG               |4278664      |                 8|
|YOURAN QI                     |5326059      |                 8|
|ZHUANG WU                     |3626007      |                 8|
|ZIFENG ZHAO                   |5099221      |                 8|
|ADIN-CRISTIAN ANDREI          |3111842      |                 7|
|BIN ZHU                       |4436066      |                 7|
|CUICUI QI                     |5015194      |                 7|
|GREGORY SHINAULT              |5127444      |                 7|
|GUN WOONG PARK                |4884161      |                 7|
|HAN CHEN                      |5010171      |                 7|
|HAO CHEN                      |5514514      |                 7|
|HAOYANG FAN                   |4725072      |                 7|
|JINGCI MENG                   |3783649      |                 7|
|JINGJIANG PENG                |3973318      |                 7|
|MARY LINDSTROM                |333334       |                 7|
|MINJING TAO                   |4392906      |                 7|
|MUHONG GAO                    |5514561      |                 7|
|NING FAN                      |5523214      |                 7|
|PAUL M TERWILLIGER            |2601093      |                 7|
|PEIGEN ZHOU                   |5326263      |                 7|
|QUEFENG LI                    |4432994      |                 7|
|SIJING LI                     |5323628      |                 7|
|YI LIU                        |4586128      |                 7|
|YUAN WANG                     |4733966      |                 7|
|YUQING XU                     |5214858      |                 7|
|ANQI SHI                      |5498092      |                 6|
|DEYUAN JIANG                  |3773167      |                 6|
|HAO ZHENG                     |4435790      |                 6|
|JIANCHANG HU                  |4886987      |                 6|
|JILI WANG                     |4734274      |                 6|
|LIAM JOHNSTON                 |4845798      |                 6|
|LONG PHAN                     |5015113      |                 6|
|PERLA REYES                   |4149787      |                 6|
|RYAN ZEA                      |3727371      |                 6|
|SANGBUM CHOI                  |3981781      |                 6|
|TAO YU                        |3781422      |                 6|
|XINXIN YU                     |4286679      |                 6|
|YAOYAO XU                     |4576059      |                 6|
|ANRU ZHANG                    |4646729      |                 5|
|BINGYING XIE                  |5144884      |                 5|
|CHANHAN HSU                   |3976099      |                 5|
|CHENLIANG XU                  |4597046      |                 5|
|CRYSTAL CHEN                  |5498648      |                 5|
|DONG XIA                      |4898014      |                 5|
|GUILHERME VIEIRA NUNES LUDWIG |4886028      |                 5|
|HAO ZHOU                      |5323690      |                 5|
|JASON P FINE                  |3011936      |                 5|
|KRISHNAKUMAR BALASUBRAMANIAN  |5476019      |                 5|
|LU YANG                       |5010560      |                 5|
|LUWAN ZHANG                   |5017774      |                 5|
|LUXI CAO                      |5192960      |                 5|
|MENG SONG                     |4280220      |                 5|
|PHILIP WOOD                   |1515839      |                 5|
|QING LI                       |5718599      |                 5|
|SEULKEE YUN                   |5520811      |                 5|
|SHANG WU                      |5515201      |                 5|
|SHIZHEN WANG                  |4598772      |                 5|
|SOHEIL SADEGHI                |5176905      |                 5|
|WESLEY CHANG                  |5161294      |                 5|
|XIAO NIE                      |4905505      |                 5|
|XIN LI                        |4285528      |                 5|
|XIPEI YANG                    |4145889      |                 5|
|XIUYU MA                      |5322566      |                 5|
|XU XU                         |4590559      |                 5|
|YANG ZHAO                     |4285354      |                 5|
|YONGFENG WU                   |5696436      |                 5|
|YUAN LI                       |5167973      |                 5|
|YUANZHI LI                    |4906458      |                 5|
|ABIGAIL BENZINE               |4787911      |                 4|
|BENJAMIN RECHT                |4632211      |                 4|
|BOWEN HU                      |5690247      |                 4|
|CHEN JING                     |5018463      |                 4|
|CHENXI LI                     |3973813      |                 4|
|CHIEN-WEI CHEN                |3613299      |                 4|
|COLE COOK                     |4312759      |                 4|
|COLIN LONGHURST               |5332940      |                 4|
|DANIELE CAPPELLETTI           |5846795      |                 4|
|FAN GAO                       |5204089      |                 4|
|FANG FANG                     |3460189      |                 4|
|HUIKUN ZHANG                  |5168069      |                 4|
|JENNIFER BIRSTLER             |4636145      |                 4|
|JIALE XU                      |4433317      |                 4|
|JIE SONG                      |5410648      |                 4|
|JOSEPH DEUTSCH                |4610245      |                 4|
|JUN LI                        |3981051      |                 4|
|KUNLING HUANG                 |5697552      |                 4|
|MICHAEL RENE KOSOROK          |989414       |                 4|
|MIN NIU                       |3965653      |                 4|
|MING XIE                      |4133622      |                 4|
|NORBERT BINKIEWICZ            |3882760      |                 4|
|PAUL SAVARIAPPAN              |5631398      |                 4|
|QIONG ZHANG                   |4460098      |                 4|
|QIURONG CUI                   |4582107      |                 4|
|SEHO PARK                     |4733192      |                 4|
|SEUNGBONG HAN                 |3573852      |                 4|
|SHIXUE LIU                    |4885477      |                 4|
|TONGHAI YANG                  |3230527      |                 4|
|TRAM TA                       |4896172      |                 4|
|VICTOR LUO                    |4641200      |                 4|
|VICTORIA MANSFIELD            |4788841      |                 4|
|XINWEI DENG                   |3620612      |                 4|
|YIFAN MEI                     |5693277      |                 4|
|YILIN ZHANG                   |5323691      |                 4|
|YONGSU LEE                    |5518378      |                 4|
|YOUNG LEE                     |5514517      |                 4|
|YOUNG MIN PARK                |5177493      |                 4|
|YU QIU LIU                    |3961448      |                 4|
|YUAN JIANG                    |3791787      |                 4|
|ZHIGUO XIAO                   |3339239      |                 4|
|ALEXANDER COVINGTON           |5656034      |                 3|
|ALEXANDER KISELEV             |3573775      |                 3|
|ALYSSA DIGILIO                |5162339      |                 3|
|BIN DAI                       |4155990      |                 3|
|BROOK LUERS                   |5011312      |                 3|
|CHAOYANG YU                   |4712098      |                 3|
|CHELSEY GREEN                 |3376532      |                 3|
|DAVID DEMETS                  |2601596      |                 3|
|DEBRAJ DAS                    |6043299      |                 3|
|DUY NGUYEN                    |4728844      |                 3|
|ERICA LEE DEADMAN             |3566378      |                 3|
|HAODA FU                      |3456935      |                 3|
|HEATHER MARIE BRAZEAU         |4149843      |                 3|
|JUN ZHANG                     |3781764      |                 3|
|KEN ONO                       |3127329      |                 3|
|KYLE HEBERT                   |5317373      |                 3|
|LILI LAN                      |3980675      |                 3|
|LU MAO                        |4726678      |                 3|
|QI JIANG                      |4633355      |                 3|
|REBECCA KOSCIK                |789363       |                 3|
|RUI CHEN                      |5690182      |                 3|
|RUI TANG                      |4128750      |                 3|
|SHANE HUBLER                  |982957       |                 3|
|TUN LEE NG                    |5567363      |                 3|
|TZU HSIANG HUNG               |5664494      |                 3|
|WAI TONG FAN                  |4434130      |                 3|
|XIRAN WANG                    |5170924      |                 3|
|YAJUAN SI                     |4426932      |                 3|
|YING ZHANG                    |5170492      |                 3|
|YUCHANG WU                    |5903922      |                 3|
|YUCHEN ZHOU                   |5700058      |                 3|
|YUJIN CHUNG                   |4144479      |                 3|
|ZHONGJIE YU                   |5693629      |                 3|
|ANDREW LESLIE                 |5003565      |                 2|
|ARNOLD MILLER                 |2600893      |                 2|
|BIN ZHANG                     |5186047      |                 2|
|CHAN PARK                     |5883206      |                 2|
|CHAOQUN MEI                   |4724058      |                 2|
|CHENGNING ZHANG               |5592111      |                 2|
|CHENSHENG KUANG               |4903489      |                 2|
|CHIA-CHIEH LIN                |3629214      |                 2|
|CLAIRE BOBST                  |5887049      |                 2|
|CLAUDIA SOLIS LEMUS           |4721578      |                 2|
|FANGFANG WANG                 |3783301      |                 2|
|GARY HOWARD SCHROEDER         |495087       |                 2|
|GENG LI                       |4957688      |                 2|
|GUANNAN SUN                   |4436002      |                 2|
|HUAIBAO FENG                  |3623432      |                 2|
|IAN BRANSTAD RILEY            |801445       |                 2|
|JASON RICHARD SWANSON         |3956063      |                 2|
|JEEA CHOI                     |4890283      |                 2|
|JENNIFER NGUYEN               |4613728      |                 2|
|JIE WEI                       |4292460      |                 2|
|JOSEP GINEBRA                 |1126199      |                 2|
|JUNGWON MUN                   |3095399      |                 2|
|JUNHEE HAN                    |3620552      |                 2|
|KATHERINE GOODE               |4491860      |                 2|
|KAZUHIKO SHINKI               |3777992      |                 2|
|LAM HO                        |4435446      |                 2|
|LEI XU                        |3443667      |                 2|
|LILI ZHENG                    |5693114      |                 2|
|MARIA ROJO                    |5167906      |                 2|
|MARIAN R FISHER               |245914       |                 2|
|MICHAEL GEORGE ILTIS          |783769       |                 2|
|MICHAEL KUTZLER               |5708167      |                 2|
|NORMAN DRAPER                 |2600689      |                 2|
|RUIFENG XU                    |3343055      |                 2|
|RUNGANG HAN                   |5898424      |                 2|
|SEAN KENT                     |5068296      |                 2|
|SHULEI WANG                   |5170885      |                 2|
|SOKOL VAKO                    |4593965      |                 2|
|STEFFEN LEMPP                 |2600973      |                 2|
|STEPHEN AARON STANHOPE        |3122658      |                 2|
|STEPHEN BERG                  |4538540      |                 2|
|STEPHEN WAINGER               |2601051      |                 2|
|TAERI UHM                     |4590738      |                 2|
|THEVAASIINEN CHANDERENG       |5023414      |                 2|
|TIEN VO                       |4896939      |                 2|
|TING YE                       |5520995      |                 2|
|TING-LI LIN                   |3351080      |                 2|
|VARSHA KULKARNI               |3959251      |                 2|
|WEI ZHENG                     |3780817      |                 2|
|XIAOPING FENG                 |4729481      |                 2|
|XINJIE HE                     |4726666      |                 2|
|XIWEN MA                      |3791802      |                 2|
|XU HE                         |4286138      |                 2|
|XUEYAO CHEN                   |4726703      |                 2|
|YALI WANG                     |3800708      |                 2|
|YONGJOON KIM                  |5644228      |                 2|
|ZHENGXIAO WU                  |3107260      |                 2|
|ALAN HUANG                    |4958796      |                 1|
|ALBERTO DEL PIA               |5451706      |                 1|
|ALBRECHT KLEMM                |3661782      |                 1|
|ALEXANDER FISH                |4680082      |                 1|
|ANATOLE BECK                  |129415       |                 1|
|ANDREJ ZLATOS                 |3674168      |                 1|
|ANNE BRUCKNER                 |4952769      |                 1|
|AUGUST JENSEN                 |4963378      |                 1|
|BEHZAD AALIPUR                |5852265      |                 1|
|BEHZAD AALIPUR HAFSHEJANI     |5694563      |                 1|
|BEN ADAM HAALAND              |4140469      |                 1|
|BI CHENG WU                   |5906523      |                 1|
|BO HUANG                      |3484236      |                 1|
|CHRISTINE SORKNESS            |138086       |                 1|
|CHRISTOPHER WAGNER            |3855025      |                 1|
|DEREK NORTON                  |5305675      |                 1|
|DIETRICH UHLENBROCK           |2600233      |                 1|
|DONGHYUN LEE                  |5620719      |                 1|
|EDWARD ERKER                  |5189535      |                 1|
|ELOISA D CHAVAS               |2824494      |                 1|
|FLORIAN BERTRAND              |4601948      |                 1|
|GINA OH                       |5862942      |                 1|
|GREGORIO MORENO-FLORES        |4761200      |                 1|
|GUANHUA CHEN                  |4272783      |                 1|
|GUILHERME ROSA                |1505756      |                 1|
|HUI WANG                      |3483534      |                 1|
|HUILIN HU                     |5167990      |                 1|
|HYUNSEUNG KANG                |4734607      |                 1|
|JAMES ANDERSON                |5515948      |                 1|
|JAMES D KUELBS                |2601633      |                 1|
|JEE YEON KIM                  |4140397      |                 1|
|JESSE THOMAS HOLZER           |3627934      |                 1|
|JIAN WU                       |4603165      |                 1|
|JOHN KANE                     |3806328      |                 1|
|JOHN WILTSHIRE-GORDON         |4896511      |                 1|
|JONATHON PETERSON             |1634418      |                 1|
|JUNHO LEE                     |4541633      |                 1|
|KAILEI CHEN                   |5012817      |                 1|
|KEEGAN KORTHAUER              |4261114      |                 1|
|KEVIN HASEGAWA ENG            |3978606      |                 1|
|KRISTEN CYFFKA                |4199106      |                 1|
|KYLE HERBET                   |5478075      |                 1|
|LAN LUO                       |5521838      |                 1|
|LANCINE KONATE                |3103459      |                 1|
|LEV BORISOV                   |3437432      |                 1|
|LIN QI                        |5514932      |                 1|
|MANJUSHA KANCHARLA            |5302154      |                 1|
|MARI PALTA                    |2601674      |                 1|
|MARIA KAMENETSKY              |4195000      |                 1|
|MATTHEW BALLARD               |3467530      |                 1|
|MICHAEL HOGAN                 |270258       |                 1|
|MICHAEL LIOU                  |5840930      |                 1|
|MICHELLE HARRIS               |394810       |                 1|
|MIHAELA IFRIM                 |6029366      |                 1|
|MIN JUNG LEE                  |3575433      |                 1|
|MITCHELL PAUKNER              |4947463      |                 1|
|NATALIA DE LEON GATTI         |1505727      |                 1|
|NELLIE LAUGHLIN               |232828       |                 1|
|NICHOLAS HENDERSON            |3523865      |                 1|
|REBECCA POST                  |5488796      |                 1|
|RICHARD A BRUALDI             |2600141      |                 1|
|ROBERT HARRON                 |4957895      |                 1|
|ROBERT R MEYER                |2601512      |                 1|
|ROBERT WAYNE GREEN            |3780010      |                 1|
|RONGJUN ZHU                   |5887858      |                 1|
|RUIFANG SONG                  |3987897      |                 1|
|SAMUEL STECHMANN              |4752238      |                 1|
|SCOTT HOTTOVY                 |5354849      |                 1|
|SCOTT JOSEPH HETZEL           |3253489      |                 1|
|SHAN LU                       |5905014      |                 1|
|SHENG WANG                    |5906594      |                 1|
|SHI JIN                       |3127330      |                 1|
|SHUAI CHEN                    |4699427      |                 1|
|SHUANG HUANG                  |4271924      |                 1|
|SHUYUN YE                     |4588354      |                 1|
|SONA Z SWANSON                |3955531      |                 1|
|SRIKANTHMADHAVAN ARAVAMUTHAN  |3884290      |                 1|
|STEVEN SAM                    |5452538      |                 1|
|SUKHENDU MEHROTRA             |3117835      |                 1|
|THU LE                        |4904255      |                 1|
|TIMOTHY IDOWU                 |4957916      |                 1|
|XIAODAN WEI                   |3343005      |                 1|
|XIAOWU DAI                    |5258581      |                 1|
|XIUFENG SHAO                  |4194670      |                 1|
|XUN ZHAO                      |3668575      |                 1|
|YANBING ZHENG                 |3457484      |                 1|
|YANNAN QIU                    |4172260      |                 1|
|YUNONG LIN                    |5907599      |                 1|
|ZHIGENG GENG                  |4588525      |                 1|
|ZIJIAN NI                     |5591917      |                 1|

 Total de professores: 379</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ATIVIDADE 2: ANÁLISE DE GPA (MÉDIA DE NOTAS)</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== ANÁLISE DE GPA ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== ANÁLISE DE GPA ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"codigo_estatistica"</span>)) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    query_gpa <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="st">        c.name as disciplina,</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="st">        c.number as numero,</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="st">        co.term_code,</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="st">        co.name as oferecimento_nome,</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.a_count, 0) AS INTEGER) as a_count,</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.ab_count, 0) AS INTEGER) as ab_count,</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.b_count, 0) AS INTEGER) as b_count,</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.bc_count, 0) AS INTEGER) as bc_count,</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.c_count, 0) AS INTEGER) as c_count,</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.d_count, 0) AS INTEGER) as d_count,</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="st">        CAST(COALESCE(gd.f_count, 0) AS INTEGER) as f_count,</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="st">        (CAST(COALESCE(gd.a_count, 0) AS INTEGER) +</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="st">          CAST(COALESCE(gd.ab_count, 0) AS INTEGER) +</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="st">          CAST(COALESCE(gd.b_count, 0) AS INTEGER) +</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="st">          CAST(COALESCE(gd.bc_count, 0) AS INTEGER) +</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="st">          CAST(COALESCE(gd.c_count, 0) AS INTEGER) +</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="st">          CAST(COALESCE(gd.d_count, 0) AS INTEGER) +</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="st">          CAST(COALESCE(gd.f_count, 0) AS INTEGER)) as total_estudantes,</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="st">        CASE</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="st">           WHEN (CAST(COALESCE(gd.a_count, 0) AS INTEGER) +</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="st">                 CAST(COALESCE(gd.ab_count, 0) AS INTEGER) +</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="st">                 CAST(COALESCE(gd.b_count, 0) AS INTEGER) +</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="st">                 CAST(COALESCE(gd.bc_count, 0) AS INTEGER) +</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="st">                 CAST(COALESCE(gd.c_count, 0) AS INTEGER) +</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="st">                 CAST(COALESCE(gd.d_count, 0) AS INTEGER) +</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="st">                 CAST(COALESCE(gd.f_count, 0) AS INTEGER)) &gt; 0</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="st">          THEN ROUND(</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="st">              (CAST(COALESCE(gd.a_count, 0) AS REAL) * 4.0 +</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.ab_count, 0) AS REAL) * 3.5 +</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.b_count, 0) AS REAL) * 3.0 +</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.bc_count, 0) AS REAL) * 2.5 +</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.c_count, 0) AS REAL) * 2.0 +</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.d_count, 0) AS REAL) * 1.0 +</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.f_count, 0) AS REAL) * 0.0) /</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="st">               (CAST(COALESCE(gd.a_count, 0) AS REAL) +</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.ab_count, 0) AS REAL) +</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.b_count, 0) AS REAL) +</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.bc_count, 0) AS REAL) +</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.c_count, 0) AS REAL) +</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.d_count, 0) AS REAL) +</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a><span class="st">                CAST(COALESCE(gd.f_count, 0) AS REAL)), 3)</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a><span class="st">          ELSE NULL</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="st">        END as gpa_medio</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM grade_distributions gd</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a><span class="st">    INNER JOIN course_offerings co ON gd.course_offering_uuid = co.uuid</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a><span class="st">    INNER JOIN courses c ON co.course_uuid = c.uuid</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a><span class="st">    INNER JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a><span class="st">    WHERE sm.subject_code = '%s'</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a><span class="st">      AND (CAST(COALESCE(gd.a_count, 0) AS INTEGER) +</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(COALESCE(gd.ab_count, 0) AS INTEGER) +</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(COALESCE(gd.b_count, 0) AS INTEGER) +</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(COALESCE(gd.bc_count, 0) AS INTEGER) +</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(COALESCE(gd.c_count, 0) AS INTEGER) +</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(COALESCE(gd.d_count, 0) AS INTEGER) +</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(COALESCE(gd.f_count, 0) AS INTEGER)) &gt; 0</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a><span class="st">    ORDER BY gpa_medio ASC</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>, codigo_estatistica)</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>      dados_gpa <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, query_gpa)</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(dados_gpa) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Dados de GPA calculados com sucesso!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Total de oferecimentos analisados: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(dados_gpa)))</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Primeiros resultados (ordenados por dificuldade):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">kable</span>(<span class="fu">head</span>(dados_gpa, <span class="dv">10</span>)))</span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>        gpas_validos <span class="ot">&lt;-</span> dados_gpa<span class="sc">$</span>gpa_medio[<span class="sc">!</span><span class="fu">is.na</span>(dados_gpa<span class="sc">$</span>gpa_medio)]</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(gpas_validos) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Usa o R para encontrar os índices min/max</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>          idx_min <span class="ot">&lt;-</span> <span class="fu">which.min</span>(gpas_validos)</span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>          idx_max <span class="ot">&lt;-</span> <span class="fu">which.max</span>(gpas_validos)</span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Ajusta o índice de volta para o data.frame completo para pegar as informações da disciplina</span></span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>          dados_gpa_validos <span class="ot">&lt;-</span> dados_gpa[<span class="sc">!</span><span class="fu">is.na</span>(dados_gpa<span class="sc">$</span>gpa_medio), ]</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>          disciplina_dificil <span class="ot">&lt;-</span> dados_gpa_validos[idx_min, ]</span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>          disciplina_facil <span class="ot">&lt;-</span> dados_gpa_validos[idx_max, ]</span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Estatísticas de GPA:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"• GPA mais baixo: %.3f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">min</span>(gpas_validos)))</span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"• GPA mais alto: %.3f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">max</span>(gpas_validos)))</span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"• GPA médio: %.3f</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">mean</span>(gpas_validos)))</span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> DISCIPLINA MAIS DIFÍCIL: %s %s (GPA: %.3f)</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>                      disciplina_dificil<span class="sc">$</span>numero, disciplina_dificil<span class="sc">$</span>disciplina, disciplina_dificil<span class="sc">$</span>gpa_medio))</span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"DISCIPLINA MAIS FÁCIL: %s %s (GPA: %.3f)</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>                      disciplina_facil<span class="sc">$</span>numero, disciplina_facil<span class="sc">$</span>disciplina, disciplina_facil<span class="sc">$</span>gpa_medio))</span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Nenhum dado de GPA encontrado.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Erro na análise GPA: %s</span><span class="sc">\n</span><span class="st">"</span>, e<span class="sc">$</span>message))</span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dados de GPA calculados com sucesso!
Total de oferecimentos analisados: 1057

Primeiros resultados (ordenados por dificuldade):


|disciplina                                                 |numero |term_code |oferecimento_nome            | a_count| ab_count| b_count| bc_count| c_count| d_count| f_count| total_estudantes| gpa_medio|
|:----------------------------------------------------------|:------|:---------|:----------------------------|-------:|--------:|-------:|--------:|-------:|-------:|-------:|----------------:|---------:|
|Introduction to Statistical Methods                        |301    |1072      |Intro-Statistical Methods    |      14|        3|      37|        6|      29|      10|      14|              113|     2.305|
|Introduction to Stochastic Processes                       |632    |1114      |Intro-Stochastic Processes   |       6|        4|       6|        2|       6|      10|       0|               34|     2.441|
|Introduction to the Theory of Probability                  |431    |1142      |Intro-Theory of Probability  |      11|        1|       8|        2|       5|       9|       3|               39|     2.449|
|Introduction to Statistical Methods                        |301    |1132      |Intro-Statistical Methods    |      23|        6|      26|        4|      25|      14|      10|              108|     2.454|
|Introduction to Probability and Mathematical Statistics II |310    |1164      |Intro to Prob &amp; Math Stat II |       7|       10|       7|        7|      14|       5|       4|               54|     2.491|
|Introductory Statistics for Engineers                      |224    |1074      |Intro Stats for Engineers    |       5|        6|       7|        5|      10|       1|       4|               38|     2.513|
|Introduction to Statistical Methods                        |301    |1144      |Intro-Statistical Methods    |      26|       12|      28|        1|      43|      11|       8|              129|     2.554|
|Introduction to the Theory of Probability                  |431    |1072      |Intro-Theory of Probability  |       5|        5|       2|        3|       6|       1|       3|               25|     2.560|
|Introduction to the Theory of Probability                  |431    |1084      |Intro-Theory of Probability  |       6|        1|      10|        7|       5|       5|       1|               35|     2.571|
|Introduction to the Theory of Probability                  |431    |1172      |Intro-Theory of Probability  |       7|        2|       6|        2|       5|       2|       3|               27|     2.593|

Estatísticas de GPA:
• GPA mais baixo: 2.305
• GPA mais alto: 4.000
• GPA médio: 3.356

 DISCIPLINA MAIS DIFÍCIL: 301 Introduction to Statistical Methods (GPA: 2.305)
DISCIPLINA MAIS FÁCIL: 998 Statistical Consulting (GPA: 4.000)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ATIVIDADE 3: RANKING DE PROFESSORES POR GPA</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== RANKING DE PROFESSORES POR GPA ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== RANKING DE PROFESSORES POR GPA ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"codigo_estatistica"</span>)) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  query_ranking <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="st">      i.name AS professor_nome,</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="st">      COUNT(DISTINCT gd.course_offering_uuid) AS num_oferecimentos,</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="st">      ROUND(AVG(</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="st">        CASE</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="st">           WHEN (COALESCE(gd.a_count,0) + COALESCE(gd.ab_count,0) + COALESCE(gd.b_count,0) +</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="st">                 COALESCE(gd.bc_count,0) + COALESCE(gd.c_count,0) + COALESCE(gd.d_count,0) +</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="st">                 COALESCE(gd.f_count,0)) &gt; 0</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="st">          THEN</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="st">            (COALESCE(gd.a_count,0)*4.0 + COALESCE(gd.ab_count,0)*3.5 + COALESCE(gd.b_count,0)*3.0 +</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="st">              COALESCE(gd.bc_count,0)*2.5 + COALESCE(gd.c_count,0)*2.0 + COALESCE(gd.d_count,0)*1.0 +</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="st">              COALESCE(gd.f_count,0)*0.0) /</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="st">            (COALESCE(gd.a_count,0) + COALESCE(gd.ab_count,0) + COALESCE(gd.b_count,0) +</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="st">              COALESCE(gd.bc_count,0) + COALESCE(gd.c_count,0) + COALESCE(gd.d_count,0) +</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="st">              COALESCE(gd.f_count,0))</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="st">          ELSE NULL</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="st">        END</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="st">      ), 3) AS gpa_medio_professor,</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="st">      SUM(COALESCE(gd.a_count,0) + COALESCE(gd.ab_count,0) + COALESCE(gd.b_count,0) +</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="st">           COALESCE(gd.bc_count,0) + COALESCE(gd.c_count,0) + COALESCE(gd.d_count,0) +</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="st">           COALESCE(gd.f_count,0)) AS total_estudantes_ensinados</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM grade_distributions gd</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN course_offerings co ON gd.course_offering_uuid = co.uuid</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN sections s ON co.uuid = s.course_offering_uuid</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN teachings t ON s.uuid = t.section_uuid</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN instructors i ON t.instructor_id = i.id</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE sm.subject_code = '%s'</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY i.name, i.id</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="st">  HAVING COUNT(DISTINCT gd.course_offering_uuid) &gt;= 1</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="st">  ORDER BY gpa_medio_professor ASC</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span>, codigo_estatistica)</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>    ranking_professores <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, query_ranking)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(ranking_professores) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"RANKING CALCULADO:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Filtra linhas com GPA válido para ranking min/max</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>      ranking_valido <span class="ot">&lt;-</span> ranking_professores[<span class="sc">!</span><span class="fu">is.na</span>(ranking_professores<span class="sc">$</span>gpa_medio_professor) <span class="sc">&amp;</span> </span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>                                            ranking_professores<span class="sc">$</span>total_estudantes_ensinados <span class="sc">&gt;</span> <span class="dv">0</span>, ]</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>                                            </span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">kable</span>(ranking_professores))</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">nrow</span>(ranking_valido) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>        idx_min <span class="ot">&lt;-</span> <span class="fu">which.min</span>(ranking_valido<span class="sc">$</span>gpa_medio_professor)</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>        idx_max <span class="ot">&lt;-</span> <span class="fu">which.max</span>(ranking_valido<span class="sc">$</span>gpa_medio_professor)</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>        professor_dificil <span class="ot">&lt;-</span> ranking_valido[idx_min, ]</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>        professor_facil   <span class="ot">&lt;-</span> ranking_valido[idx_max, ]</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Professor considerado MAIS DIFÍCIL (menor GPA médio):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- %s (GPA médio = %.3f, N. Oferecimentos = %d)</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>                    professor_dificil<span class="sc">$</span>professor_nome, professor_dificil<span class="sc">$</span>gpa_medio_professor, professor_dificil<span class="sc">$</span>num_oferecimentos))</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Professor considerado MAIS FÁCIL (maior GPA médio):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- %s (GPA médio = %.3f, N. Oferecimentos = %d)</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>                    professor_facil<span class="sc">$</span>professor_nome, professor_facil<span class="sc">$</span>gpa_medio_professor, professor_facil<span class="sc">$</span>num_oferecimentos))</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>         <span class="fu">cat</span>(<span class="st">"Nenhum professor com dados de notas válidos para o ranking de GPA.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">" Nenhum professor encontrado com dados suficientes.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Erro no ranking: %s</span><span class="sc">\n</span><span class="st">"</span>, e<span class="sc">$</span>message))</span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RANKING CALCULADO:


|professor_nome                | num_oferecimentos| gpa_medio_professor| total_estudantes_ensinados|
|:-----------------------------|-----------------:|-------------------:|--------------------------:|
|CHRISTINE SORKNESS            |                 1|                  NA|                          0|
|GUILHERME ROSA                |                 1|                  NA|                          0|
|MARIAN R FISHER               |                 2|                  NA|                          0|
|MICHAEL RENE KOSOROK          |                 4|                  NA|                          0|
|NATALIA DE LEON GATTI         |                 1|                  NA|                          0|
|JAMES D KUELBS                |                 1|               2.599|                         65|
|JONATHON PETERSON             |                 1|               2.777|                         65|
|XIUFENG SHAO                  |                 1|               2.779|                        104|
|ALEXANDER FISH                |                 1|               2.807|                         75|
|KAILEI CHEN                   |                 1|               2.808|                        492|
|GINA OH                       |                 1|               2.829|                       1236|
|MANJUSHA KANCHARLA            |                 1|               2.829|                       1236|
|MITCHELL PAUKNER              |                 1|               2.829|                       1236|
|SHENG WANG                    |                 1|               2.829|                       1236|
|XIAOWU DAI                    |                 1|               2.829|                        824|
|JUNGWON MUN                   |                 2|               2.830|                        656|
|STEPHEN WAINGER               |                 2|               2.831|                        135|
|SCOTT HOTTOVY                 |                 1|               2.845|                        145|
|ALEXANDER KISELEV             |                 3|               2.846|                        226|
|DAVID GRIFFEATH               |                13|               2.851|                        658|
|HAODA FU                      |                 3|               2.853|                       1728|
|BROOK LUERS                   |                 3|               2.879|                       3338|
|GREGORY SHINAULT              |                 7|               2.880|                        986|
|ZHENGXIAO WU                  |                 2|               2.880|                       2793|
|KYLE HERBET                   |                 1|               2.890|                       1752|
|MARIA KAMENETSKY              |                 1|               2.890|                       1168|
|ANATOLE BECK                  |                 1|               2.917|                         73|
|BIN DAI                       |                 3|               2.921|                        678|
|TONGHAI YANG                  |                 4|               2.929|                        266|
|FLORIAN BERTRAND              |                 1|               2.936|                        102|
|ROBERT HARRON                 |                 1|               2.942|                         43|
|BO HUANG                      |                 1|               2.947|                       3016|
|JUN ZHANG                     |                 3|               2.948|                       5326|
|GINA BENNINGER                |                 8|               2.950|                       8047|
|YING ZHANG                    |                 3|               2.950|                       4746|
|LAM HO                        |                 2|               2.951|                        856|
|XIRAN WANG                    |                 3|               2.954|                       2512|
|ERICA LEE DEADMAN             |                 3|               2.961|                       3966|
|LIN QI                        |                 1|               2.963|                       1096|
|BEN ADAM HAALAND              |                 1|               2.964|                       2235|
|ELOISA D CHAVAS               |                 1|               2.964|                        745|
|MIN JUNG LEE                  |                 1|               2.964|                       1490|
|SCOTT JOSEPH HETZEL           |                 1|               2.964|                       1490|
|THOMAS G. KURTZ               |                11|               2.965|                        260|
|RUIFANG SONG                  |                 1|               2.971|                        145|
|GARY HOWARD SCHROEDER         |                 2|               2.972|                        790|
|CHEN JING                     |                 4|               2.976|                       6637|
|XIWEN MA                      |                 2|               2.978|                        920|
|JENNIFER NGUYEN               |                 2|               2.982|                       1185|
|XIAO NIE                      |                 5|               2.982|                       4246|
|STEFFEN LEMPP                 |                 2|               2.983|                        290|
|HEATHER MARIE BRAZEAU         |                 3|               2.988|                       4607|
|PHILIP WOOD                   |                 5|               2.991|                        451|
|VICTOR LUO                    |                 4|               2.993|                       3253|
|MIHAELA IFRIM                 |                 1|               2.995|                        290|
|SONA Z SWANSON                |                 1|               2.996|                       1364|
|IAN BRANSTAD RILEY            |                 2|               2.999|                       1748|
|STEPHEN BERG                  |                 2|               3.001|                       2163|
|GREGORIO MORENO-FLORES        |                 1|               3.007|                        206|
|SUKHENDU MEHROTRA             |                 1|               3.007|                        103|
|ALBERTO DEL PIA               |                 1|               3.008|                         59|
|DAVID ANDERSON                |                10|               3.008|                        841|
|HUILIN HU                     |                 1|               3.008|                         59|
|YUAN JIANG                    |                 4|               3.010|                       2941|
|SAMUEL STECHMANN              |                 1|               3.011|                        115|
|YALI WANG                     |                 2|               3.011|                       1545|
|MICHAEL FERRIS                |                10|               3.013|                        400|
|YUANZHI LI                    |                 5|               3.014|                       6538|
|YUCHEN ZHOU                   |                 3|               3.016|                       2446|
|DONG XIA                      |                 5|               3.019|                       1241|
|TAERI UHM                     |                 2|               3.020|                        280|
|XU HE                         |                 2|               3.030|                       2358|
|KUNLING HUANG                 |                 4|               3.031|                       3051|
|RICHARD A BRUALDI             |                 1|               3.031|                         32|
|GENG LI                       |                 2|               3.032|                       2446|
|YUJIN CHUNG                   |                 3|               3.032|                        223|
|LONG PHAN                     |                 6|               3.033|                       8528|
|WAI TONG FAN                  |                 3|               3.037|                        283|
|JASON RICHARD SWANSON         |                 2|               3.038|                         94|
|CHENXI LI                     |                 4|               3.039|                       5487|
|TIEN VO                       |                 2|               3.041|                       3196|
|ARNOLD MILLER                 |                 2|               3.042|                         70|
|VARSHA KULKARNI               |                 2|               3.042|                       1742|
|XINYU SONG                    |                14|               3.045|                      10405|
|MICHAEL GEORGE ILTIS          |                 2|               3.047|                        312|
|SANGBUM CHOI                  |                 6|               3.050|                      10943|
|ZHONGJIE YU                   |                 3|               3.051|                       4902|
|WESLEY CHANG                  |                 5|               3.052|                       6029|
|KEVIN PACKARD                 |                11|               3.053|                       7887|
|LANCINE KONATE                |                 1|               3.057|                         88|
|GUN WOONG PARK                |                 7|               3.062|                       6881|
|SHIXUE LIU                    |                 4|               3.062|                       7455|
|DIETRICH UHLENBROCK           |                 1|               3.063|                         27|
|LEV BORISOV                   |                 1|               3.063|                         27|
|NICHOLAS STEPHEN KEULER       |                22|               3.064|                       4353|
|YIFAN MEI                     |                 4|               3.070|                       1009|
|YOUNG MIN PARK                |                 4|               3.070|                       2490|
|STEVEN SAM                    |                 1|               3.071|                         35|
|ANDREW LESLIE                 |                 2|               3.072|                       3288|
|DANIELE CAPPELLETTI           |                 4|               3.073|                        455|
|BINGYING XIE                  |                 5|               3.074|                       6173|
|CUIZE HAN                     |                 9|               3.077|                       4054|
|YONGFENG WU                   |                 5|               3.077|                       3280|
|YUAN WANG                     |                 7|               3.078|                       2565|
|HAOYANG FAN                   |                 7|               3.082|                       9084|
|JOHN WILTSHIRE-GORDON         |                 1|               3.082|                         85|
|PAUL M TERWILLIGER            |                 7|               3.082|                        335|
|RUI CHEN                      |                 3|               3.083|                       2481|
|RUIFENG XU                    |                 2|               3.085|                       1056|
|JEEA CHOI                     |                 2|               3.086|                        355|
|RICHARD A. JOHNSON            |                 8|               3.087|                       1696|
|SHENG WANG                    |                10|               3.087|                      10891|
|SHIZHEN WANG                  |                 5|               3.087|                       3156|
|DEYUAN JIANG                  |                 6|               3.091|                       5614|
|TIMOTHY IDOWU                 |                 8|               3.092|                       4002|
|SEULKEE YUN                   |                 5|               3.094|                       3697|
|ANDREJ ZLATOS                 |                 1|               3.096|                         84|
|CRYSTAL CHEN                  |                 5|               3.096|                       6162|
|DONGHYUN LEE                  |                 1|               3.096|                         84|
|HUIKUN ZHANG                  |                 4|               3.097|                       2983|
|SEHO PARK                     |                 4|               3.097|                       3870|
|YU QIU LIU                    |                 4|               3.097|                       4446|
|JINGCI MENG                   |                 7|               3.101|                       9135|
|CHEN CHENG                    |                 9|               3.102|                       7876|
|ISMOR FISCHER                 |                31|               3.103|                      17472|
|SHI JIN                       |                 1|               3.104|                         48|
|LUXI CAO                      |                 5|               3.105|                        719|
|TIMO SEPPALAINEN              |                19|               3.106|                       1153|
|FANG FANG                     |                 4|               3.110|                       1057|
|ALEXANDER COVINGTON           |                 3|               3.112|                       2656|
|PERLA REYES                   |                 6|               3.112|                       9289|
|XIN LI                        |                 5|               3.113|                       6302|
|STEPHEN WRIGHT                |                14|               3.114|                        639|
|MIN NIU                       |                 4|               3.118|                       5881|
|YAOGUO XIE                    |                11|               3.118|                       5600|
|YOUNGDEOK HWANG               |                 8|               3.119|                       6770|
|CHIEN-WEI CHEN                |                 4|               3.121|                       2303|
|JUNHEE HAN                    |                 2|               3.123|                        708|
|KYLE HEBERT                   |                 3|               3.123|                       1443|
|BOWEN HU                      |                 4|               3.125|                       3231|
|DONALD PORTER                 |                28|               3.126|                      12081|
|JARED BROWN                   |                 8|               3.126|                       3138|
|JU HEE CHO                    |                10|               3.126|                      11249|
|DUY NGUYEN                    |                 3|               3.127|                        662|
|SEUNGBONG HAN                 |                 4|               3.127|                       5268|
|QIONG ZHANG                   |                 4|               3.128|                       5980|
|KRISTEN CYFFKA                |                 1|               3.129|                       1476|
|XIPEI YANG                    |                 5|               3.130|                       5031|
|CHANHAN HSU                   |                 5|               3.131|                      12600|
|TING-LI LIN                   |                 2|               3.131|                        849|
|DOUGLAS M. BATES              |                22|               3.132|                       1456|
|QUOC TRAN                     |                 8|               3.132|                       8880|
|ZUOFENG SHANG                 |                10|               3.132|                       9085|
|ALAN HUANG                    |                 1|               3.136|                        845|
|KAM-WAH TSUI                  |                41|               3.136|                       4941|
|THU LE                        |                 1|               3.136|                        845|
|CHENLIANG XU                  |                 5|               3.138|                       5301|
|HAO TENG                      |                 8|               3.139|                       5001|
|JINGLAN LI                    |                10|               3.140|                       6769|
|ZIFENG ZHAO                   |                 8|               3.140|                       5434|
|BI CHENG WU                   |                 1|               3.141|                       1602|
|RONGJUN ZHU                   |                 1|               3.141|                       1602|
|YUNONG LIN                    |                 1|               3.141|                       1068|
|BENEDEK VALKO                 |                16|               3.144|                        965|
|CHENGNING ZHANG               |                 2|               3.144|                        481|
|SEBASTIEN ROCH                |                11|               3.144|                        691|
|LILUN DU                      |                10|               3.152|                       5098|
|JOHN DAVIS                    |                11|               3.155|                       7021|
|MENG SONG                     |                 5|               3.155|                       3616|
|AKICHIKA OZEKI                |                 9|               3.157|                       4612|
|MICHAEL HOGAN                 |                 1|               3.159|                        378|
|NELLIE LAUGHLIN               |                 1|               3.159|                        378|
|KRISHNAKUMAR BALASUBRAMANIAN  |                 5|               3.161|                        540|
|TRAM TA                       |                 4|               3.162|                       5295|
|JIE WEI                       |                 2|               3.165|                       2966|
|XINJIE HE                     |                 2|               3.165|                       2966|
|XUEYAO CHEN                   |                 2|               3.165|                       2966|
|SHENG ZHANG                   |                10|               3.167|                      11274|
|ZHIGUO XIAO                   |                 4|               3.168|                       1496|
|YONGJOON KIM                  |                 2|               3.171|                       1724|
|JIAN WU                       |                 1|               3.172|                        732|
|XUN ZHAO                      |                 1|               3.172|                       2196|
|YI LI                         |                10|               3.175|                       5505|
|ROBERT WARDROP                |                28|               3.176|                      15891|
|TUN LEE NG                    |                 3|               3.176|                       1874|
|YUCHANG WU                    |                 3|               3.176|                        951|
|JIALE XU                      |                 4|               3.177|                       4771|
|WEI ZHENG                     |                 2|               3.179|                       1461|
|YILIN ZHANG                   |                 4|               3.180|                       4263|
|SHANE HUBLER                  |                 3|               3.181|                       1551|
|LU YANG                       |                 5|               3.183|                       3807|
|JIE ZHANG                     |                 9|               3.184|                      13010|
|MING XIE                      |                 4|               3.184|                       7492|
|YAOYAO XU                     |                 6|               3.184|                       4646|
|SOHEIL SADEGHI                |                 5|               3.185|                       3613|
|AUGUST JENSEN                 |                 1|               3.186|                        639|
|BIN ZHANG                     |                 2|               3.187|                        824|
|XINWEI DENG                   |                 4|               3.188|                       4441|
|JUN YIN                       |                 8|               3.190|                        477|
|YI LIU                        |                 7|               3.190|                       5080|
|BIN ZHU                       |                 7|               3.191|                       5706|
|MINJING TAO                   |                 7|               3.193|                       8284|
|RUI TANG                      |                 3|               3.193|                       3956|
|WENWEN ZHANG                  |                 9|               3.194|                       6905|
|YOURAN QI                     |                 8|               3.197|                       3977|
|CHAN PARK                     |                 2|               3.199|                       1251|
|CLAIRE BOBST                  |                 2|               3.199|                        834|
|QI TANG                       |                 8|               3.199|                       8350|
|RUNGANG HAN                   |                 2|               3.199|                       1251|
|SEAN KENT                     |                 2|               3.199|                       1251|
|COLIN LONGHURST               |                 4|               3.202|                        829|
|HAN CHEN                      |                 7|               3.204|                       2976|
|JINGJIANG PENG                |                 7|               3.204|                       3465|
|SHANG WU                      |                 5|               3.205|                       2586|
|HYEBIN SONG                   |                 8|               3.207|                       7629|
|JOHN KANE                     |                 1|               3.209|                        201|
|MARIA ROJO                    |                 2|               3.211|                       2952|
|YAN CHEN                      |                 8|               3.212|                       4742|
|FAN YANG                      |                 9|               3.214|                       4789|
|FREDERICK BOEHM               |                 9|               3.214|                       1903|
|KATHERINE GOODE               |                 2|               3.215|                       1014|
|YANG ZHAO                     |                 5|               3.215|                       6399|
|HAO ZHOU                      |                 5|               3.216|                       4934|
|NICHOLAS HENDERSON            |                 1|               3.218|                        286|
|CHAOYANG YU                   |                 3|               3.219|                       1882|
|HAO CHEN                      |                 7|               3.219|                       4458|
|MUHONG GAO                    |                 7|               3.219|                       3239|
|XIN ZHANG                     |                11|               3.219|                       4771|
|PEIGEN ZHOU                   |                 7|               3.220|                       3131|
|GONZALO CONTADOR              |                 9|               3.221|                       2128|
|TAO YU                        |                 6|               3.223|                        578|
|KAZUHIKO SHINKI               |                 2|               3.226|                       1285|
|MICHAEL KUTZLER               |                 2|               3.228|                       1721|
|FAN GAO                       |                 4|               3.230|                       2319|
|JIAJIE CHEN                   |                10|               3.232|                       4740|
|JIANCHANG HU                  |                 6|               3.234|                       3129|
|CHELSEY GREEN                 |                 3|               3.235|                       2173|
|CHIA-CHIEH LIN                |                 2|               3.235|                       1493|
|WENZHI CAO                    |                 9|               3.237|                       7465|
|SOKOL VAKO                    |                 2|               3.238|                       1700|
|CLAUDIA SOLIS LEMUS           |                 2|               3.239|                       3415|
|HAO ZHENG                     |                 6|               3.242|                       4495|
|JUN LI                        |                 4|               3.242|                       4243|
|RUOSI GUO                     |                13|               3.242|                      10187|
|SHULEI WANG                   |                 2|               3.243|                       3147|
|REBECCA POST                  |                 1|               3.245|                        513|
|YI CHAI                       |                12|               3.246|                       5963|
|DEREK NORTON                  |                 1|               3.247|                        624|
|KEEGAN KORTHAUER              |                 1|               3.247|                        208|
|ROBERT R MEYER                |                 1|               3.250|                          8|
|SIJING LI                     |                 7|               3.255|                       5217|
|DEBRAJ DAS                    |                 3|               3.257|                        540|
|QUEFENG LI                    |                 7|               3.257|                       9081|
|ABIGAIL BENZINE               |                 4|               3.260|                       3070|
|BRET HANLON                   |                29|               3.261|                       3834|
|XU XU                         |                 5|               3.261|                       2797|
|QIURONG CUI                   |                 4|               3.262|                       1664|
|ANRU ZHANG                    |                 5|               3.263|                        524|
|XIAO GUO                      |                11|               3.269|                       4692|
|DONGGYU KIM                   |                 8|               3.274|                       5830|
|TONG LI                       |                 9|               3.274|                       8452|
|HUI WANG                      |                 1|               3.287|                        556|
|KEVIN HASEGAWA ENG            |                 1|               3.287|                        834|
|XIAODAN WEI                   |                 1|               3.287|                        278|
|PAUL SAVARIAPPAN              |                 4|               3.295|                        691|
|LILI ZHENG                    |                 2|               3.297|                       2787|
|YUQING XU                     |                 7|               3.297|                       3615|
|VICTORIA MANSFIELD            |                 4|               3.299|                       2745|
|LUWAN ZHANG                   |                 5|               3.302|                       1115|
|YANNAN QIU                    |                 1|               3.304|                         28|
|JIWEI ZHAO                    |                 9|               3.307|                       1301|
|JOSEP GINEBRA                 |                 2|               3.310|                        258|
|ZHUANG WU                     |                 8|               3.312|                       8781|
|TZU HSIANG HUNG               |                 3|               3.315|                       2821|
|YONGSU LEE                    |                 4|               3.316|                       2287|
|JILI WANG                     |                 6|               3.318|                       5442|
|LIE XIONG                     |                 8|               3.318|                       3589|
|XIAOPING FENG                 |                 2|               3.318|                       2121|
|GARVESH RASKUTTI              |                21|               3.319|                        984|
|TIMOTHY IDOWU                 |                 1|               3.321|                       1002|
|XIUYU MA                      |                 5|               3.323|                       1311|
|MATTHEW BALLARD               |                 1|               3.326|                         43|
|XINXIN YU                     |                 6|               3.326|                       1740|
|BENJAMIN RECHT                |                 4|               3.331|                        185|
|SHUYUN YE                     |                 1|               3.332|                        742|
|BO YANG                       |                10|               3.334|                       3223|
|DUZHE WANG                    |                 9|               3.337|                       4024|
|JIE SONG                      |                 4|               3.337|                       4444|
|LAN LUO                       |                 1|               3.342|                       1398|
|RYAN ZEA                      |                 6|               3.347|                       3723|
|NORBERT BINKIEWICZ            |                 4|               3.353|                       1112|
|XIAOMAO LI                    |                 9|               3.361|                       4499|
|BEHZAD AALIPUR                |                 1|               3.366|                       1248|
|ALBRECHT KLEMM                |                 1|               3.368|                         19|
|SONG WANG                     |                 8|               3.373|                       6712|
|LEI XU                        |                 2|               3.379|                        604|
|DEREK BEAN                    |                 9|               3.386|                       1578|
|SHENGJI JIA                   |                16|               3.387|                       4236|
|ALYSSA DIGILIO                |                 3|               3.390|                       1052|
|KEN ONO                       |                 3|               3.394|                         78|
|LIAM JOHNSTON                 |                 6|               3.394|                       2998|
|CHENSHENG KUANG               |                 2|               3.398|                       1153|
|TING YE                       |                 2|               3.407|                        518|
|NING FAN                      |                 7|               3.410|                       3878|
|YAZHEN WANG                   |                36|               3.411|                        743|
|QING LI                       |                 5|               3.422|                       4984|
|KARL ROHE                     |                38|               3.429|                       1064|
|WEI-YIN LOH                   |                56|               3.441|                       1173|
|ROBERT WAYNE GREEN            |                 1|               3.454|                        204|
|HYUNSEUNG KANG                |                 1|               3.456|                         57|
|ANQI SHI                      |                 6|               3.460|                       3442|
|CECILE ANE                    |                38|               3.472|                       1118|
|MARI PALTA                    |                 1|               3.474|                         19|
|SHUAI CHEN                    |                 1|               3.474|                         19|
|BEHZAD AALIPUR HAFSHEJANI     |                 1|               3.475|                        180|
|JESSE THOMAS HOLZER           |                 1|               3.478|                         46|
|SUNDUZ KELES                  |                37|               3.491|                        504|
|CUICUI QI                     |                 7|               3.492|                       1483|
|COLE COOK                     |                 4|               3.510|                        716|
|ZHIGENG GENG                  |                 1|               3.512|                        846|
|ANNE BRUCKNER                 |                 1|               3.517|                        250|
|GUILHERME VIEIRA NUNES LUDWIG |                 5|               3.517|                       1447|
|EDWARD ERKER                  |                 1|               3.518|                        226|
|QI JIANG                      |                 3|               3.518|                        541|
|BRET LARGET                   |                41|               3.521|                        878|
|ERIK NORDHEIM                 |                59|               3.527|                       1060|
|JENNIFER BIRSTLER             |                 4|               3.529|                       4636|
|ZHENGJUN ZHANG                |                60|               3.531|                       1220|
|RONALD GANGNON                |                18|               3.532|                        194|
|YOUNG LEE                     |                 4|               3.534|                       4829|
|STEPHEN AARON STANHOPE        |                 2|               3.555|                        501|
|JEE YEON KIM                  |                 1|               3.571|                         56|
|CHRISTOPHER WAGNER            |                 1|               3.574|                         68|
|SHUANG HUANG                  |                 1|               3.574|                         94|
|GUANNAN SUN                   |                 2|               3.579|                        101|
|LILI LAN                      |                 3|               3.580|                       1534|
|QIAN ZHIGUANG                 |                49|               3.583|                        959|
|MURRAY CLAYTON                |                25|               3.594|                        853|
|JOHN GILLETT                  |                24|               3.606|                      13645|
|KJELL DOKSUM                  |                15|               3.609|                        145|
|KYUNGMANN KIM                 |                19|               3.612|                        198|
|SIJIAN WANG                   |                29|               3.613|                        856|
|JAMES ANDERSON                |                 1|               3.615|                         26|
|ZIJIAN NI                     |                 1|               3.616|                        138|
|ZHANG CHUNMING                |                47|               3.618|                        948|
|JUN ZHU                       |                33|               3.619|                        449|
|THOMAS COOK                   |                 8|               3.627|                        134|
|JUNHO LEE                     |                 1|               3.643|                         28|
|HUAIBAO FENG                  |                 2|               3.645|                         38|
|MICHELLE HARRIS               |                 1|               3.647|                         41|
|MARY LINDSTROM                |                 7|               3.661|                        273|
|YUAN LI                       |                 5|               3.671|                       2638|
|NORMAN DRAPER                 |                 2|               3.680|                         25|
|MOO K CHUNG                   |                18|               3.682|                         11|
|THEVAASIINEN CHANDERENG       |                 2|               3.692|                       1106|
|YANBING ZHENG                 |                 1|               3.692|                         13|
|JUN SHAO                      |                46|               3.695|                        608|
|PAUL RATHOUZ                  |                 8|               3.695|                        381|
|JASON P FINE                  |                 5|               3.719|                         16|
|JOSEPH DEUTSCH                |                 4|               3.723|                       1971|
|CHRISTINA M. KENDZIORSKI      |                30|               3.725|                        108|
|ADIN-CRISTIAN ANDREI          |                 7|               3.749|                        164|
|KARL BROMAN                   |                16|               3.762|                        348|
|RICHARD J. CHAPPELL           |                41|               3.765|                        275|
|REBECCA KOSCIK                |                 3|               3.772|                        990|
|FANGFANG WANG                 |                 2|               3.773|                         56|
|SHAN LU                       |                 1|               3.775|                        254|
|MICHAEL NEWTON                |                38|               3.790|                        254|
|BRIAN YANDELL                 |                37|               3.799|                        119|
|MICHAEL LIOU                  |                 1|               3.814|                        177|
|DAVID DEMETS                  |                 3|               3.833|                         21|
|LU MAO                        |                 3|               3.910|                         51|
|MING YUAN                     |                 8|               3.925|                         68|
|CHAOQUN MEI                   |                 2|               3.938|                         97|
|YU MENGGANG                   |                13|               3.939|                        109|
|GRACE WAHBA                   |                31|               3.973|                        156|
|GUANHUA CHEN                  |                 1|               4.000|                         16|
|SRIKANTHMADHAVAN ARAVAMUTHAN  |                 1|               4.000|                         16|
|YAJUAN SI                     |                 3|               4.000|                         46|

 Professor considerado MAIS DIFÍCIL (menor GPA médio):
- JAMES D KUELBS (GPA médio = 2.599, N. Oferecimentos = 1)

 Professor considerado MAIS FÁCIL (maior GPA médio):
- GUANHUA CHEN (GPA médio = 4.000, N. Oferecimentos = 1)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># FINALIZAÇÃO</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================================================</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(conn)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Conexão com o banco de dados encerrada.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Conexão com o banco de dados encerrada.</code></pre>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>